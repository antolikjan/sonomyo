---
import Section from '../../../components/ui/Section.astro'
import Row from '../../../components/ui/Row.astro'
import Col from '../../../components/ui/Col.astro'
import Post from '../../../components/ui/cards/BlogCard.astro'
import TagNavigation from '../../../components/ui/blog/TagNavigation.astro'

type Props = {
  data: any[]
  lang: 'cs' | 'en'
}

const { data: allPosts, lang } = Astro.props

const sortedPosts = [...allPosts].sort((a: any, b: any) => {
  return new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime()
})

// turns "cs/blog/tongue_position" into "tongue_position"
const toSlug = (id: string) => id.replace(`${lang}/blog/`, '')
---
<Section>
  <Row>
    <Col span="12">
      <TagNavigation lang={lang} />
    </Col>

    {sortedPosts.map((post: any) => (
      <Col span="4">
        <Post
          link={`/${lang}/blog/${toSlug(post.id)}`}
          title={post.data.title}
          subtitle={`By ${post.data.author} on ${new Date(post.data.pubDate).toLocaleDateString(
            lang === 'cs' ? 'cs-CZ' : 'en-US',
            { year: 'numeric', month: 'long', day: 'numeric' }
          )}`}
          image={post.data.image}
          tags={post.data.tags}
        >
          {post.data.description}
        </Post>
      </Col>
    ))}
  </Row>
</Section>
